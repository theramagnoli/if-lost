import{_ as b,l as _,o as v,b as m,r as x,s as y,u as w,m as k,I as C,d as F,c as d,e as p,f as s,t as f,i as U,h as g,F as A}from"./index.e333e8b3.js";const E={data(){return{img:null,paso:0,nombres:"",borrar_perfil:!1}},computed:{currentRouteName(){return this.$route.name},usuario(){return this.$store.state.usuario}},methods:{cerrarSesi\u00F3n(){_(m).then(()=>{this.$router.push("/login")}).catch(a=>{})},obtenerUsuario(){let a=this;v(m,e=>{e?(this.nombres=e.displayName,this.$route.name=="cuenta"&&fetch("https://firebasestorage.googleapis.com/v0/b/if-lost-159f6.appspot.com/o/perfiles%2F"+a.usuario.id).then(function(i){return i.json()}).then(function(i){i.name&&(a.$refs.perfil.src="https://firebasestorage.googleapis.com/v0/b/if-lost-159f6.appspot.com/o/perfiles%2F"+a.usuario.id+"?alt=media")})):this.$router.push("/login")})},subirImg(a){let e=this;this.img=a.target.files[0];const i=new FileReader;i.readAsDataURL(this.img),i.onload=function(n){const o=document.createElement("img");o.src=n.target.result,o.onload=function(t){const r=document.createElement("canvas"),l=500,c=l/t.target.width;r.width=l,r.height=c*t.target.height;const u=r.getContext("2d");u.drawImage(t.target,0,0,r.width,r.height);const h=u.canvas.toDataURL(t.target,"image/png");e.$refs.perfil.src=h,e.img=1}}},async guardar(){let a=this;function e(n,o){for(var t=n.split(","),r=t[0].match(/:(.*?);/)[1],l=atob(t[1]),c=l.length,u=new Uint8Array(c);c--;)u[c]=l.charCodeAt(c);return new File([u],o,{type:r})}if(a.img==1){var i=e(a.$refs.perfil.src,"perfil.png");const n=x(y,"perfiles/"+a.usuario.id);await w(n,i).then(o=>{})}await k(C(F,"infoUsuarios",this.usuario.id),{descripcion:a.$refs.nuevadescripcion.value,perfil:"https://firebasestorage.googleapis.com/v0/b/if-lost-159f6.appspot.com/o/perfiles%2F"+a.usuario.id+"?alt=media"}),this.usuario.descripcion=this.$refs.nuevadescripcion.value,this.paso=0},reload(){this.paso=0}},async mounted(){this.obtenerUsuario()}},I={class:"grid"},N=s("h1",{class:"text-3xl font-bold text-center tracking-wide"},"Mi cuenta",-1),R={class:"place-self-center pt-4 grid mt-6"},$={src:"https://firebasestorage.googleapis.com/v0/b/if-lost-159f6.appspot.com/o/perfiles%2Fperfil.png?alt=media",alt:"perfil",ref:"perfil",width:"200",class:"perfil"},j={class:"text-3xl font-semibold tracking-wide text-center mt-5"},B={class:"mt-2 text-center text-sm"},S=s("i",{class:"fa-solid fa-location-pin"},null,-1),V={key:0,class:"grid"},z=s("p",{class:"mt-8 px-4 font-semibold"},"Acerca de ti",-1),D={key:0,class:"px-4"},L={key:1,class:"px-4"},q={key:0,class:"grid"},G=s("label",{type:"input",for:"perfil",class:"btn-gray my-4 border-0 text-center justify-self-center"}," Actualizar foto de perfil ",-1),M=["value"];function O(a,e,i,n,o,t){return d(),p(A,null,[s("div",I,[N,s("div",R,[s("img",$,null,512)]),s("h4",j,f(t.usuario.nombre),1),s("p",B,[S,U("\xA0\xA0"+f(t.usuario.ciudad),1)]),o.paso==0?(d(),p("div",V,[z,t.usuario.descripcion?(d(),p("p",D,f(t.usuario.descripcion),1)):(d(),p("p",L," \xBFQu\xE9 te gustar\xEDa que el mundo supiera de "+f(t.usuario.nombre)+"? Edita tu perfil para actualizar tu descripci\xF3n ",1)),s("button",{onClick:e[0]||(e[0]=r=>o.paso=1),class:"btn-blue mt-12"}," Editar perfil "),s("button",{onClick:e[1]||(e[1]=r=>t.cerrarSesi\u00F3n()),class:"btn-red"},"Cerrar sesi\xF3n")])):g("",!0)]),o.paso==1?(d(),p("div",q,[G,s("input",{id:"perfil",type:"file",accept:".jpg, .jpeg, .png",onChange:e[2]||(e[2]=r=>t.subirImg(r)),class:"hidden",required:""},null,32),s("textarea",{ref:"nuevadescripcion",class:"inp",rows:"3",value:t.usuario.descripcion},null,8,M),s("button",{onClick:e[3]||(e[3]=r=>t.guardar()),ref:"guardar",class:"btn-blue"}," Guardar cambios ",512),s("button",{onClick:e[4]||(e[4]=r=>t.reload()),class:"btn-gray"},"Volver y descartar")])):g("",!0)],64)}var T=b(E,[["render",O]]);export{T as default};
