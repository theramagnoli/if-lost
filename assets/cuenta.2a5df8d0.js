import{_ as b,m as _,o as v,b as f,r as y,s as x,u as w,n as k,I as C,i as L,c as d,d as g,e as r,t as p,g as h,F as $}from"./index.6399a472.js";const U={data(){return{img:null,perfil:"",paso:0,borrar_perfil:!1}},computed:{currentRouteName(){return this.$route.name},usuario(){return this.$store.state.usuario}},methods:{cerrarSesi\u00F3n(){_(f).then(()=>{this.$router.push("/login")}).catch(a=>{})},obtenerUsuario(){v(f,a=>{a||this.$router.push("/login")})},subirImg(a){let t=this;this.img=a.target.files[0];const c=new FileReader;c.readAsDataURL(this.img),c.onload=function(n){const i=document.createElement("img");i.src=n.target.result,i.onload=function(e){const s=document.createElement("canvas"),u=500,o=u/e.target.width;s.width=u,s.height=o*e.target.height;const l=s.getContext("2d");l.drawImage(e.target,0,0,s.width,s.height);const m=l.canvas.toDataURL(e.target,"image/png");t.$refs.perfil.src=m,t.img=1}}},async guardar(){this.$refs.guardar.innerHTML="Guardando...";let a=this;function t(n,i){for(var e=n.split(","),s=e[0].match(/:(.*?);/)[1],u=atob(e[1]),o=u.length,l=new Uint8Array(o);o--;)l[o]=u.charCodeAt(o);return new File([l],i,{type:s})}if(a.img==1){var c=t(a.$refs.perfil.src,"perfil.png");const n=y(x,"perfiles/"+a.usuario.id);await w(n,c).then(i=>{})}await k(C(L,"infoUsuarios",this.usuario.id),{descripcion:a.$refs.nuevadescripcion.value}),this.usuario.descripcion=this.$refs.nuevadescripcion.value,this.$refs.guardar.innerHTML="Se guardaron los cambios",this.$refs.guardar.classList.add("bg-green-400","hover:bg-green-400"),setTimeout(function(n){a.$refs.guardar.innerHTML="Guardar cambios",a.$refs.guardar.classList.remove("bg-green-400","hover:bg-green-400")},2e3)}},async mounted(){this.perfil=this.usuario.perfil,this.obtenerUsuario()}},A={class:"grid"},E=r("h1",{class:"ttl-1"},"Mi perfil",-1),F={class:"place-self-center grid"},I=["src"],R={class:"text-3xl font-medium text-center mt-5"},S={class:"mt-1 text-center text-sm text-gray-500"},B={key:0,class:"grid"},M=r("p",{class:"mt-8 px-4 font-semibold"},"Acerca de ti",-1),T={key:0,class:"px-4"},j={key:1,class:"px-4"},z={key:0,class:"grid"},D=r("label",{type:"input",for:"perfil",class:"btn-gray my-4 border-0 text-center justify-self-center"}," Actualizar foto de perfil ",-1),G=["value"];function H(a,t,c,n,i,e){return d(),g($,null,[r("div",A,[E,r("div",F,[r("img",{src:i.perfil,alt:"perfil",ref:"perfil",class:"perfil"},null,8,I)]),r("div",null,[r("h4",R,p(e.usuario.nombre),1),r("p",S," de "+p(e.usuario.ciudad),1)]),i.paso==0?(d(),g("div",B,[M,e.usuario.descripcion?(d(),g("p",T,p(e.usuario.descripcion),1)):(d(),g("p",j," \xBFQu\xE9 te gustar\xEDa que el mundo supiera de ti? Edita tu perfil para actualizar tu descripci\xF3n ")),r("button",{onClick:t[0]||(t[0]=s=>i.paso=1),class:"btn-blue mt-12"}," Editar perfil "),r("button",{onClick:t[1]||(t[1]=s=>e.cerrarSesi\u00F3n()),class:"btn-red"},"Cerrar sesi\xF3n")])):h("",!0)]),i.paso==1?(d(),g("div",z,[D,r("input",{id:"perfil",type:"file",accept:".jpg, .jpeg, .png",onChange:t[2]||(t[2]=s=>e.subirImg(s)),class:"hidden",required:""},null,32),r("textarea",{ref:"nuevadescripcion",class:"inp",rows:"3",value:e.usuario.descripcion},null,8,G),r("button",{onClick:t[3]||(t[3]=s=>e.guardar()),ref:"guardar",class:"btn-blue"}," Guardar cambios ",512),r("button",{onClick:t[4]||(t[4]=s=>i.paso=0),class:"btn-gray"},"Volver y descartar")])):h("",!0)],64)}var V=b(U,[["render",H]]);export{V as default};
