import{_ as v,l as y,o as x,r as g,s as h,m as w,b as m,u as k,n as C,I as L,d as U,c as d,e as p,f as r,t as f,h as b,F as $}from"./index.c0493cc3.js";const A={data(){return{img:null,perfil:"https://firebasestorage.googleapis.com/v0/b/if-lost-159f6.appspot.com/o/perfiles%2Fperfil.png?alt=media&token=5a6ff639-cdc5-4372-a6c7-adc73e14fe47",paso:0,borrar_perfil:!1}},computed:{currentRouteName(){return this.$route.name},usuario(){return this.$store.state.usuario}},methods:{cerrarSesi\u00F3n(){y(m).then(()=>{this.$router.push("/login")}).catch(a=>{})},obtenerUsuario(){x(m,a=>{if(a){const e=g(h,"perfiles/"+this.usuario.id);w(e).then(n=>{this.perfil=n}).catch(n=>{})}else this.$router.push("/login")})},subirImg(a){let e=this;this.img=a.target.files[0];const n=new FileReader;n.readAsDataURL(this.img),n.onload=function(o){const i=document.createElement("img");i.src=o.target.result,i.onload=function(t){const s=document.createElement("canvas"),l=500,c=l/t.target.width;s.width=l,s.height=c*t.target.height;const u=s.getContext("2d");u.drawImage(t.target,0,0,s.width,s.height);const _=u.canvas.toDataURL(t.target,"image/png");e.$refs.perfil.src=_,e.img=1}}},async guardar(){this.$refs.guardar.innerHTML="Guardando...";let a=this;function e(o,i){for(var t=o.split(","),s=t[0].match(/:(.*?);/)[1],l=atob(t[1]),c=l.length,u=new Uint8Array(c);c--;)u[c]=l.charCodeAt(c);return new File([u],i,{type:s})}if(a.img==1){var n=e(a.$refs.perfil.src,"perfil.png");const o=g(h,"perfiles/"+a.usuario.id);await k(o,n).then(i=>{})}await C(L(U,"infoUsuarios",this.usuario.id),{descripcion:a.$refs.nuevadescripcion.value}),this.usuario.descripcion=this.$refs.nuevadescripcion.value,this.$refs.guardar.innerHTML="Se guardaron los cambios",this.$refs.guardar.classList.add("bg-green-400","hover:bg-green-400"),setTimeout(function(o){a.$refs.guardar.innerHTML="Guardar cambios",a.$refs.guardar.classList.remove("bg-green-400","hover:bg-green-400")},2e3)}},async mounted(){this.obtenerUsuario()}},F={class:"grid"},R=r("h1",{class:"ttl-1"},"Mi perfil",-1),E={class:"place-self-center grid"},I=["src"],S={class:"text-3xl font-medium text-center mt-5"},B={class:"mt-1 text-center text-sm text-gray-500"},D={key:0,class:"grid"},M=r("p",{class:"mt-8 px-4 font-semibold"},"Acerca de ti",-1),T={key:0,class:"px-4"},j={key:1,class:"px-4"},z={key:0,class:"grid"},G=r("label",{type:"input",for:"perfil",class:"btn-gray my-4 border-0 text-center justify-self-center"}," Actualizar foto de perfil ",-1),H=["value"];function N(a,e,n,o,i,t){return d(),p($,null,[r("div",F,[R,r("div",E,[r("img",{src:i.perfil,alt:"perfil",ref:"perfil",class:"perfil"},null,8,I)]),r("div",null,[r("h4",S,f(t.usuario.nombre),1),r("p",B," de "+f(t.usuario.ciudad),1)]),i.paso==0?(d(),p("div",D,[M,t.usuario.descripcion?(d(),p("p",T,f(t.usuario.descripcion),1)):(d(),p("p",j," \xBFQu\xE9 te gustar\xEDa que el mundo supiera de ti? Edita tu perfil para actualizar tu descripci\xF3n ")),r("button",{onClick:e[0]||(e[0]=s=>i.paso=1),class:"btn-blue mt-12"}," Editar perfil "),r("button",{onClick:e[1]||(e[1]=s=>t.cerrarSesi\u00F3n()),class:"btn-red"},"Cerrar sesi\xF3n")])):b("",!0)]),i.paso==1?(d(),p("div",z,[G,r("input",{id:"perfil",type:"file",accept:".jpg, .jpeg, .png",onChange:e[2]||(e[2]=s=>t.subirImg(s)),class:"hidden",required:""},null,32),r("textarea",{ref:"nuevadescripcion",class:"inp",rows:"3",value:t.usuario.descripcion},null,8,H),r("button",{onClick:e[3]||(e[3]=s=>t.guardar()),ref:"guardar",class:"btn-blue"}," Guardar cambios ",512),r("button",{onClick:e[4]||(e[4]=s=>i.paso=0),class:"btn-gray"},"Volver y descartar")])):b("",!0)],64)}var q=v(A,[["render",N]]);export{q as default};
